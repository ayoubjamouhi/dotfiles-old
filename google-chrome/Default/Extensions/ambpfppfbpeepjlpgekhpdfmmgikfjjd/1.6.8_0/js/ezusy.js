var loading=this.chrome.extension.getURL("images/loading.svg"),done=this.chrome.extension.getURL("images/done.png"),logo=this.chrome.extension.getURL("images/logo.png"),error=this.chrome.extension.getURL("images/error.png"),ezusy_box='<div class="ezusy-messages"></div>',close=this.chrome.extension.getURL("images/close.png"),imported=this.chrome.extension.getURL("images/imported.png"),error=this.chrome.extension.getURL("images/error.svg");$("body").append(ezusy_box);var exists='<div class="exist"></div>';$("body").append(exists),function(a){a.fn.ezusy=function(b){if(1!=b.split){var c=a.extend({product_url:"1"},b),d=new Noty({type:"alert",theme:"defaultTheme",text:a.fn.ezusy.message(c,'<p><img width="24px" src="'+loading+'" />Importing to Ezusy</p>'),closeWith:["button"]}).show(),e=c.product_url.split("?"),f=e[0].split("/");f=f[f.length-1],f=f.split("."),f=f[0],f.indexOf("_")>-1&&(f=f.split("_"),f=f[1]),c.id=f,-1==e[0].indexOf("https")&&(e[0]="https:"+e[0]);chrome.runtime.sendMessage({ajax:"get_alii_html",data:{settings:c},data_send:{url:e[0],method:"GET",cache:!1,data:{url:e[0]},dataType:"html"},type:"get_alii_html"}),chrome.runtime.onMessage.addListener(function(a,b,c){"res_save_alii"==a.type&&d.close()})}else{var c=a.extend({product_url:"1"},b),d=new Noty({type:"alert",theme:"defaultTheme",text:a.fn.ezusy.message(c,'<p><img width="24px" src="'+loading+'" />Splitting product</p>'),closeWith:["button"]}).show();c.product.options=c.options,opt=c.opt,c.product.ali_url=c.product_url,c.product.opts[opt]=c.product.optsplit,chrome.runtime.sendMessage({ajax:"split_product",data:{settings:c,item:c.product},data_send:{}}),chrome.runtime.onMessage.addListener(function(a,b,c){"res_save_alii"==a.type&&d.close()})}},a.fn.ezusy.message=function(a,b){return'<div class="ezusy-import-product><div class="ezusy-loading"> <div class="noty-product-details"><img class="primg" width="100px" src="'+a.product_image+'" /> <div><p class="ezusy-product-title">'+a.product_title.trim().substring(0,80)+'...</p> <p class="ezusy-status">'+b+"</p> </div>"},a.fn.ezusy.error=function(a,b){var c=new Noty({type:"warning",theme:"defaultTheme",text:"Opps! Something not correct. Please contact us to fix this error.",buttons:[Noty.button("Contact now","ezusy-btn",function(){window.open("https://www.ezusy.com/contact-us/","_blank"),c.close()},{"data-status":"ok"}),Noty.button("Cancel","ezusy-btn",function(){c.close()})],closeWith:["button"]}).show()}}(jQuery),chrome.runtime.onMessage.addListener(function(a,b,c){if("error-ajax"==a.type){new Noty({type:"alert",theme:"defaultTheme",text:$.fn.ezusy.message("Error server"),closeWith:["button"]}).show()}});var message=function(a,b){return'<div class="ezusy-import-product><div class="ezusy-loading"> <div class="noty-product-details"><img class="primg" width="100px" src="'+a.product_image+'" /> <div><p class="ezusy-product-title">'+a.product_title.trim().substring(0,80)+'...</p> <p class="ezusy-status">'+b+"</p> </div>"};chrome.runtime.onMessage.addListener(function(a,b,c){if("res_save_alii"==a.type){var d=JSON.parse(a.data);if(1==d.success){var e=new Noty({type:"alert",theme:"defaultTheme",text:message(a.settings,'<div class="ezusy-imported"><img width="12px" src="'+imported+'" /> Imported</div>'),closeWith:["button"]}).show();e.setTimeout(5e3)}else if(0==d.success&&1==d.imported){var e=new Noty({type:"alert",theme:"defaultTheme",text:message(a.settings,'<span class="information"><img width="18px" src="'+error+'" />This product already exists</span>'),closeWith:["button"]}).show();e.setTimeout(5e3)}else if(3==d.success)var f=new Noty({type:"warning",theme:"sunset",text:"You should login on Ezusy",buttons:[Noty.button("Login","ryviu-btn",function(){window.open("https://www.ezusy.com/login/","_blank"),f.close()}),Noty.button("Cancel","ryviu-btn",function(){f.close()})],closeWith:["button"],killer:!0}).show();else if(0==d.success&&1==d.limit){e.close();var g=new Noty({type:"warning",text:"Your account was imported over limit products",buttons:[Noty.button("Upgrade","ezusy-btn",function(){window.open("https://www.ezusy.com/pricing/","_blank"),f.close()}),Noty.button("Cancel","ezusy-btn",function(){g.close()})],closeWith:["button"]}).show()}}});