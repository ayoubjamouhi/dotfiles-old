function _init(){chrome.storage.local.get("shipping",function(result){function ucwords(a){return a=(a+"").toLowerCase(),a.replace(/^([a-z])|\s+([a-z])/g,function(a){return a.toUpperCase()})}var shipping=result.shipping,t=window.document.createElement("script");t.id="ezusy.com",t.text='var window_csrf_token = function(json){console.log(json);window.postMessage({type:"ezusy_addcart",json:json},"*")}',window.document.head.appendChild(t),$.ajax({type:"POST",url:"https://ilogisticsaddress.aliexpress.com/AjaxQueryCountries",success:function(a){console.log(a)},dataType:"jsonp",jsonpCallback:"window_csrf_token",data:{country:shipping.country}}),window.addEventListener("message",function(event){if("ezusy_addcart"==event.data.type){addressList=event.data.json.addressList;var state,city;if(addressList.length>0?(address=addressList.find(function(a){return shipping.state?a.n==ucwords(shipping.state):a.n==ucwords(shipping.city)}),address?state=ucwords(shipping.state):(state=addressList[0].n,error.push("Province")),address&&"children"in address&&address.children?(city=address.children.find(function(a){return a.n==ucwords(shipping.city)}),city?city=ucwords(shipping.city):(city=address.children[0].n,error.push("City"))):(city="children"in addressList[0]&&addressList[0].children?addressList[0].children[0].n:ucwords(shipping.city),error.push("City"))):(state=shipping.city?ucwords(shipping.city):"New York",city=shipping.city?ucwords(shipping.city):"New york"),mobileNo=123456789,phoneArea="+1",shipping.override_phone){var phoneObj=shipping.override_phone.split(" ");phoneObj.length>0&&(phoneArea=phoneObj[0].indexOf("+")>-1?phoneObj[0]:"+"+phoneObj[0],mobileNo=phoneObj[1])}else shipping.phone&&(mobileNo=shipping.phone),phoneArea=""!=phoneCode[shipping.country]?phoneCode[shipping.country]:"+1";setTimeout(function(){$("script").each(function(){if($(this).text().indexOf("window._csrf_token_")>-1){eval($(this).text());var data={_csrf_token_:window._csrf_token_,phoneCountry:phoneArea,contactPerson:shipping.first_name+" "+shipping.last_name,mobileNo:mobileNo,zip:shipping.postcode,address:shipping.address_1,address2:shipping.address_2?shipping.address_2:shipping.address_1,country:shipping.country?shipping.country.toUpperCase():"US",province:state,city:city};chrome.runtime.sendMessage({data_send:data,type:"add_address"})}})},1e3)}})})}function _state(){setTimeout(function(){chrome.storage.local.get("shipping",function(a){var b=document.querySelector(".sa-province-wrapper select"),c=a.shipping.state;""==b.value||b.value!=c?0==$(b).find("option").length?ez("province").value=c:(b.value=c,b.dispatchEvent(new Event("change"))):_state()})},1e3)}function _city(){setTimeout(function(){chrome.storage.local.get("shipping",function(a){var b=document.querySelector(".sa-city-wrapper select"),c=document.querySelector(".sa-province-wrapper select"),d=a.shipping.state;""==b.value||b.value!=city&&c.value==d?(0==$(b).find("option").length?ez("city").value=city:($(b).find("option").each(function(){$(this).text().toLowerCase()==city.toLowerCase()&&(city=$(this).text())}),b.value=city,b.dispatchEvent(new Event("change"))),checkout()):_city()})},2e3)}function _phonecode(a){a&&setTimeout(function(){ez("phoneCountry").value!=a?ez("phoneCountry").value=a:_phonecode()},1e3)}function ez(a){return document.querySelector('[name="'+a+'"]')}function _check(){var a="";return ez("address")||(a="address"),ez("address2")||(a="address2"),!ez("phoneCountry")&&ez("phoneCountry").value&&(a="phoneCountry"),!ez("mobileNo")&&ez("mobileNo").value&&(a="mobileNo"),ez("contactPerson")||(a="contactPerson"),t&&""==a&&!click&&(click=!0,t.click(),a=1),a}function checkout(){chrome.storage.local.get("shipping",function(a){var b=document.querySelector(".sa-city-wrapper select"),c=document.querySelector(".sa-province-wrapper select"),d=a.shipping.state;setTimeout(function(){ez("province").value==d||c.value==d?b.value!=city&&ez("city").value!=city||(confirm.click(),chrome.storage.local.set({check_out:!1,confirm_step:!0})):checkout()},1e3)})}var vars={},parts=window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(a,b,c){vars[b]=c});tuan=!0;var ezusy=document,confirm=ezusy.querySelector(".sa-btn-group .sa-confirm"),click=!1,t=ezusy.querySelector(".sa-operation .sa-edit"),phoneCode={VU:"+678",EC:"+593",VN:"+84",VI:"",DZ:"+213",VG:"+1",DM:"+1",VE:"+58",DO:"+1",VC:"+1",VA:"+39",DE:"+49",UZ:"+998",UY:"+598",DK:"+45",DJ:"+253",US:"+1",UM:"",UG:"+256",UA:"+380",ET:"+251",ES:"+34",ER:"+291",EH:"+212",EG:"+20",TZ:"+255",EE:"+372",TT:"+1",TV:"+688",GD:"+1",GE:"+995",GF:"+594",GA:"+241",ASC:"",GB:"+44",FR:"+33",FO:"+298",FK:"+500",FJ:"+679",FM:"+691",FI:"+358",WS:"+685",GY:"+592",GW:"+245",GU:"",GT:"+502",GR:"+30",GQ:"+240",WF:"+681",GP:"+590",GN:"+224",GM:"+220",GL:"+299",GI:"+350",GH:"+233",GG:"+44",RE:"+262",RO:"+40",AT:"+43",AS:"",AR:"+54",AQ:"",AX:"",AW:"+297",QA:"+974",AU:"+61",AZ:"+994",BA:"+387",PT:"+351",AD:"+376",PW:"+680",AG:"+1",PR:"+1",AE:"+971",PS:"",AF:"",AL:"+355",AI:"+2",AO:"+244",PY:"+595",AM:"+374",AN:"+9",TG:"+228",BW:"+267",TF:"",BV:"+3",BY:"+375",TD:"+235",BS:"+1 (242)",TK:"",TJ:"+992",BR:"+55",TH:"+66",BT:"+975",TO:"+676",TN:"+216",TM:"+993",CA:"+1",TL:"+670",BZ:"+501",TR:"+90",BF:"+226",SV:"+503",BG:"+359",SS:"+211",BH:"+973",ST:"+239",BI:"+257",SY:"+963",BB:"+1",SZ:"+268",BD:"+880",SX:"+590",BE:"+32",BN:"+673",BO:"+591",BQ:"",BJ:"+229",TC:"+1",BL:"",BM:"+1",CZ:"+420",SD:"+249",CY:"+357",SC:"+248",CX:"",CW:"",SE:"+46",CV:"+238",SH:"",CU:"+53",SG:"+65",SJ:"+47",SI:"+386",SL:"+232",SK:"+421",SN:"+221",SM:"+378",SO:"+252",SGS:"",SR:"+597",CI:"+225",RS:"+381",CG:"+242",CH:"+41",RU:"+7",CF:"+236",RW:"+250",CC:"",CD:"+243",CR:"+506",CO:"+57",CM:"+237",CN:"+86",CK:"",SA:"+966",CL:"+56",SB:"+677",LV:"+371",LU:"+352",LT:"+370",LY:"+218",LS:"+266",LR:"+231",MG:"+261",MH:"+692",ME:"+382",MF:"",MK:"+389",ML:"+223",MC:"+377",MD:"+373",MA:"+212",MV:"+960",MU:"+230",MX:"+52",MW:"+265",MZ:"+258",MY:"+60",MN:"+976",MM:"+95",MP:"",MR:"+222",MQ:"+596",MT:"+356",MS:"",NF:"",NG:"+234",NI:"+505",NL:"+31",NA:"+264",NC:"+687",NE:"+227",NZ:"+64",NU:"",NR:"+674",NP:"+977",NO:"+47",OM:"+968",PL:"+48",PM:"+508",PN:"",PH:"+63",PK:"+92",PE:"+51",PF:"+689",PG:"+675",PA:"+507",ZA:"+27",HN:"+504",HM:"",HR:"+385",EAZ:"",HT:"+509",HU:"+36",ZM:"+260",ID:"+62",ZW:"+263",IE:"+353",IL:"+972",IM:"+44",IN:"+91",IO:"",IQ:"+964",IR:"+98",YE:"+967",IS:"+354",IT:"+39",JE:"+44",YT:"+262",JP:"+81",JO:"+962",JM:"+1",KI:"+686",KH:"",KG:"+996",KE:"+254",GBA:"",KP:"+850",KR:"+82",KM:"+269",KN:"+1 (869)",KW:"+965",KY:"+1",KZ:"+77",KS:"",LA:"+856",LC:"+1",LB:"+961",LI:"+423",LK:"+94"};chrome.storage.local.get("check_out_new",function(a){chrome.storage.local.get("error",function(b){chrome.storage.local.get("done_order",function(c){if(0==c.done_order){if(0==b.error.length&&a.check_out_new&&void 0===vars.changeAddress&&!c.done_order){var d="";d+='<h3 class="ezusy-box-header">Fulfil Orders Automatically</h3>',d+='<h3 class="ezusy-box-notice-head ezusy-finished">1. Add to cart</h3>',d+='<h3 class="ezusy-box-notice-head ezusy-finished">2. Delete address</h3>',d+='<h3 class="ezusy-box-notice-head ezusy-finished">3. Select shipping method</h3>',d+='<h3 class="ezusy-box-notice-head ezusy-current">4. Checkout</h3>',d+='<p class="ezusy-box-message">Please wait a minute and do not leave this tab. Adding shipping address...</p>',d+='<h3 class="ezusy-box-notice-head">5. Confirm & Pay</h3>';var e=document.createElement("div");e.className="ezusy-box-notice",e.innerHTML=d,document.body.appendChild(e),window.onload=function(){_init()}}}else{var d="";d+='<h3 class="ezusy-box-header">Fulfil Orders Automatically</h3>',d+='<h3 class="ezusy-box-notice-head ezusy-finished">1. Add to cart</h3>',d+='<h3 class="ezusy-box-notice-head ezusy-finished">2. Delete address</h3>',d+='<h3 class="ezusy-box-notice-head ezusy-finished">3. Select shipping method</h3>',d+='<h3 class="ezusy-box-notice-head ezusy-finished"">4. Checkout</h3>',d+='<h3 class="ezusy-box-notice-head ezusy-finished"">5. Confirm & Pay</h3>';var e=document.createElement("div");e.className="ezusy-box-notice",e.innerHTML=d,document.body.appendChild(e)}})})});var res={},error=[];chrome.runtime.onMessage.addListener(function(a,b,c){if("ajax_address"==a.type){res=JSON.parse(a.data);var d=!1;if(chrome.storage.local.get("done_order",function(a){1==a.done_order&&(d=!0)}),0!=error.length||d)chrome.storage.local.set({error:error,check_out_new:!1,check_out_new_err:!0});else{$(".ezusy-box-notice").remove();var e="";e+='<h3 class="ezusy-box-header">Fulfil Orders Automatically</h3>',e+='<h3 class="ezusy-box-notice-head ezusy-finished">1. Add to cart</h3>',e+='<h3 class="ezusy-box-notice-head ezusy-finished">2. Delete address</h3>',e+='<h3 class="ezusy-box-notice-head ezusy-finished">3. Select shipping method</h3>',e+='<h3 class="ezusy-box-notice-head ezusy-finished"">4. Checkout</h3>',e+='<h3 class="ezusy-box-notice-head ezusy-finished"">5. Confirm & Pay</h3>';var f=document.createElement("div");f.className="ezusy-box-notice",f.innerHTML=e,document.body.appendChild(f),chrome.storage.local.set({done_order:"true"})}location.reload()}});